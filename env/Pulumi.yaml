name: env
runtime: yaml
description: Centralized environment contract that exposes ARM-managed foundations to services via stack outputs.

config:
  arm:subscriptionId:
    type: string
  arm:location:
    type: string
  arm:resourceGroupName:
    type: string
  arm:networkResourceGroupName:
    type: string
  arm:vnetName:
    type: string
  arm:subnetName:
    type: string
  arm:opsResourceGroupName:
    type: string
  arm:logAnalyticsWorkspaceName:
    type: string
  arm:keyVaultName:
    type: string

variables:
  subnetId: /subscriptions/${arm:subscriptionId}/resourceGroups/${arm:networkResourceGroupName}/providers/Microsoft.Network/virtualNetworks/${arm:vnetName}/subnets/${arm:subnetName}
  logAnalyticsWorkspaceId: /subscriptions/${arm:subscriptionId}/resourceGroups/${arm:opsResourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/${arm:logAnalyticsWorkspaceName}
  keyVaultUri: https://${arm:keyVaultName}.vault.azure.net/

outputs:
  subscriptionId: ${arm:subscriptionId}
  resourceGroupName: ${arm:resourceGroupName}
  location: ${arm:location}
  subnetId: ${subnetId}
  logAnalyticsWorkspaceId: ${logAnalyticsWorkspaceId}
  keyVaultUri: ${keyVaultUri}
